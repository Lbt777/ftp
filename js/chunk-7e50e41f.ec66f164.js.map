{"version":3,"sources":["webpack:///./src/view/userDestroy/index.vue?290e","webpack:///./src/assets/bian.png","webpack:///./src/view/userDestroy/index.vue?9d66","webpack:///src/view/userDestroy/index.vue","webpack:///./src/view/userDestroy/index.vue?ceb8","webpack:///./src/view/userDestroy/index.vue"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","_m","_v","_s","balance","$t","on","$event","to","attrs","changeInput","model","value","callback","$$v","number","_n","expression","times","_l","el","index","key","class","current","name","all","num","accMul","btnLoading","userOperation","btnText","_f","grandTotalAward","awardLoading","awardDisabled","IncomeCollection","staticRenderFns","data","type","userRefuseSign","sign","timer","allowance","time","filters","NumFormat","computed","address","srscontractInstance","destroyContractInstance","web3","watch","newData","old","mounted","methods","arg1","arg2","m","val","Toast","token","localStorage","award","res","console","receiveAward","mount","BigToSmall","send","from","then","catch","information","loginDestroy","getInfo","getsign","clearInterval","JSON","Dialog","title","confirmButtonColor","message","getBalanceOf","obtainAuthorization","approve","destroyAddress","getAllowance","call","quantity","userDestroy","burn","setTimeout","path","query","beforeRouteLeave","next","destroyed","component"],"mappings":"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","file":"js/chunk-7e50e41f.ec66f164.js","sourcesContent":["export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/_less-loader@7.3.0@less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=33f218c9&lang=less&scoped=true&\"","module.exports = __webpack_public_path__ + \"img/bian.f449fb5f.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"destroy\"},[_c('div',{staticClass:\"main\"},[_c('div',{staticClass:\"icon\"},[_vm._m(0),_c('div',{staticClass:\"balc\"},[_vm._v(_vm._s(_vm.balance))])]),_c('div',{staticClass:\"content\"},[_c('div',{staticClass:\"box\"},[_c('div',{staticClass:\"my\"},[_c('div',{staticClass:\"tip\"},[_vm._v(_vm._s(_vm.$t('destroy')))]),_c('div',{staticClass:\"records\",on:{\"click\":function($event){return _vm.to(1)}}},[_c('span',[_vm._v(_vm._s(_vm.$t('meta.destroyRecords')))]),_c('i',{staticClass:\"van-icon van-icon-arrow-left van-nav-bar__arrow\"})])]),_c('div',{staticClass:\"input\"},[_c('van-field',{staticClass:\"inputStyle\",attrs:{\"clearable\":\"\",\"placeholder\":\"0\",\"type\":\"number\"},on:{\"input\":_vm.changeInput},model:{value:(_vm.number),callback:function ($$v) {_vm.number=_vm._n($$v)},expression:\"number\"}}),_c('div',{staticClass:\"times\"},[_vm._v(_vm._s(_vm.times)+_vm._s(_vm.$t('times')))])],1),_c('div',{staticClass:\"option\"},_vm._l((_vm.time),function(el,index){return _c('div',{key:index,staticClass:\"items\",class:_vm.current == el.name ? 'active' : '',on:{\"click\":function($event){_vm.current = el.name;_vm.all[0].num = _vm.accMul(_vm.number, _vm.times)}}},[_vm._v(_vm._s(el.name)+_vm._s(_vm.$t('month')))])}),0),_c('div',{staticClass:\"all\"},_vm._l((_vm.all),function(el,index){return _c('div',{key:index,staticClass:\"line\"},[_c('div',[_vm._v(_vm._s(_vm.$t(el.name)))]),_c('span',[_vm._v(_vm._s(el.num))])])}),0)]),_c('van-button',{staticClass:\"btn\",attrs:{\"type\":\"primary\",\"color\":\"#1F75D9\",\"loading\":_vm.btnLoading,\"block\":\"\"},on:{\"click\":_vm.userOperation}},[_vm._v(_vm._s(_vm.$t(_vm.btnText)))])],1),_c('div',{staticClass:\"profit\"},[_c('div',{staticClass:\"my\"},[_c('div',{staticClass:\"tip\"},[_vm._v(_vm._s(_vm.$t('myHarvest')))]),_c('div',{staticClass:\"records\",on:{\"click\":function($event){return _vm.to(2)}}},[_c('span',[_vm._v(_vm._s(_vm.$t('meta.NFTrecords')))]),_c('i',{staticClass:\"van-icon van-icon-arrow-left van-nav-bar__arrow\"})])]),_c('div',{staticClass:\"receive\"},[_c('div',{staticClass:\"lpNum\"},[_c('div',{staticClass:\"n\"},[_vm._v(_vm._s(_vm._f(\"NumFormat\")(_vm.grandTotalAward)))]),_c('div',{staticClass:\"unit\"},[_vm._v(\"SRS\")])]),_c('van-button',{staticClass:\"btns\",attrs:{\"type\":\"primary\",\"color\":\"#1F75D9\",\"loading\":_vm.awardLoading,\"disabled\":_vm.awardDisabled,\"block\":\"\"},on:{\"click\":_vm.IncomeCollection}},[_vm._v(_vm._s(_vm.$t('receive')))])],1)])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"slide\"},[_c('div',{staticClass:\"images\"},[_c('img',{attrs:{\"src\":require(\"@/assets/bian.png\"),\"alt\":\"\"}})]),_c('div',{staticClass:\"lp\"},[_vm._v(\"SRS\")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"destroy\">\r\n    <div class=\"main\">\r\n      <div class=\"icon\">\r\n        <div class=\"slide\">\r\n          <div class=\"images\">\r\n            <img src=\"@/assets/bian.png\"\r\n                 alt=\"\">\r\n          </div>\r\n          <div class=\"lp\">SRS</div>\r\n        </div>\r\n        <div class=\"balc\">{{balance}}</div>\r\n      </div>\r\n      <div class=\"content\">\r\n        <div class=\"box\">\r\n          <div class=\"my\">\r\n            <div class=\"tip\">{{$t('destroy')}}</div>\r\n            <div class=\"records\"\r\n                 @click=\"to(1)\">\r\n              <span>{{$t('meta.destroyRecords')}}</span>\r\n              <i class=\"van-icon van-icon-arrow-left van-nav-bar__arrow\"></i>\r\n            </div>\r\n          </div>\r\n          <div class=\"input\">\r\n            <van-field v-model.number=\"number\"\r\n                       @input=\"changeInput\"\r\n                       clearable\r\n                       class=\"inputStyle\"\r\n                       placeholder=\"0\"\r\n                       type=\"number\" />\r\n            <!-- 1.2 1.5 1.8 -->\r\n            <div class=\"times\">{{times}}{{$t('times')}}</div>\r\n          </div>\r\n          <div class=\"option\">\r\n            <div class=\"items\"\r\n                 :class=\"current == el.name ? 'active' : ''\"\r\n                 v-for=\"(el, index) in time\"\r\n                 @click=\"current = el.name;all[0].num = accMul(number, times)\"\r\n                 :key=\"index\">{{el.name}}{{$t('month')}}</div>\r\n          </div>\r\n          <div class=\"all\">\r\n            <div class=\"line\"\r\n                 v-for=\"(el, index) in all\"\r\n                 :key=\"index\">\r\n              <div>{{$t(el.name)}}</div>\r\n              <span>{{el.num}}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <van-button type=\"primary\"\r\n                    class=\"btn\"\r\n                    color=\"#1F75D9\"\r\n                    :loading=\"btnLoading\"\r\n                    @click=\"userOperation\"\r\n                    block>{{$t(btnText)}}</van-button>\r\n      </div>\r\n      <div class=\"profit\">\r\n        <div class=\"my\">\r\n          <div class=\"tip\">{{$t('myHarvest')}}</div>\r\n          <div class=\"records\"\r\n               @click=\"to(2)\">\r\n            <span>{{$t('meta.NFTrecords')}}</span>\r\n            <i class=\"van-icon van-icon-arrow-left van-nav-bar__arrow\"></i>\r\n          </div>\r\n        </div>\r\n        <div class=\"receive\">\r\n          <div class=\"lpNum\">\r\n            <div class=\"n\">{{grandTotalAward | NumFormat()}}</div>\r\n            <div class=\"unit\">SRS</div>\r\n          </div>\r\n          <van-button type=\"primary\"\r\n                      class=\"btns\"\r\n                      color=\"#1F75D9\"\r\n                      :loading=\"awardLoading\"\r\n                      :disabled=\"awardDisabled\"\r\n                      @click=\"IncomeCollection\"\r\n                      block>{{$t('receive')}}</van-button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {\r\n  NumFormat\r\n} from '@/util/filter.js'\r\nimport BigToSmall from '@/util/BNUtils.js'\r\nimport {\r\n  destroyAddress\r\n} from '@/util/casinoContract.js'\r\nimport {\r\n  loginDestroy,\r\n  getInfo,\r\n  award\r\n} from '@/api/request.js'\r\nimport {\r\n  Toast,\r\n  Dialog\r\n} from 'vant';\r\nexport default {\r\n  data () {\r\n    return {\r\n      number: '',\r\n      current: 3,\r\n      type: 0,\r\n      balance: '',\r\n      btnLoading: false,\r\n      awardLoading: false,\r\n      userRefuseSign: false, // 用户拒绝签名\r\n      awardDisabled: false,\r\n      btnText: 'approve',\r\n      sign: '', // 签名\r\n      timer: null,\r\n      allowance: 0, // 授权数量\r\n      grandTotalAward: 0, // 累计奖励 我的收益 领取\r\n      time: [\r\n        {\r\n          name: 3,\r\n        },\r\n        {\r\n          name: 6\r\n        },\r\n        {\r\n          name: 12\r\n        }\r\n      ],\r\n      all: [\r\n        {\r\n          name: 'expectedEarnings',\r\n          num: 0\r\n        },\r\n        {\r\n          name: 'allProfit',\r\n          num: 0\r\n        },\r\n        {\r\n          name: 'teamDestroy',\r\n          num: 0\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  filters: {\r\n    NumFormat,\r\n  },\r\n  computed: {\r\n    address () {\r\n      return this.$store.state.address\r\n    },\r\n    srscontractInstance () {\r\n      return this.$store.state.srscontractInstance\r\n    },\r\n    // 销毁合约\r\n    destroyContractInstance () {\r\n      return this.$store.state.destroyContractInstance\r\n    },\r\n    web3 () {\r\n      return this.$store.state.WEB3\r\n    },\r\n    // 倍数\r\n    times () {\r\n      if (this.current == 3) return 1.2\r\n      if (this.current == 6) return 1.5\r\n      if (this.current == 12) return 1.8\r\n    }\r\n  },\r\n  watch: {\r\n    srscontractInstance (newData, old) {\r\n      this.getBalanceOf(newData, this.address)\r\n      this.getAllowance()\r\n      this.getsign()\r\n    }\r\n  },\r\n  mounted () {\r\n    this.btnLoading = true\r\n    if (this.srscontractInstance) {\r\n      this.getBalanceOf(this.srscontractInstance, this.address)\r\n      this.getAllowance()\r\n      this.getsign()\r\n    }\r\n    this.userRefuseSign = localStorage.getItem('userRefuseSign') || false\r\n  },\r\n  methods: {\r\n    // 乘法精度解决\r\n    accMul (arg1, arg2) {\r\n      var m = 0, s1 = arg1.toString(), s2 = arg2.toString();\r\n      try { m += s1.split(\".\")[1].length } catch (e) { }\r\n      try { m += s2.split(\".\")[1].length } catch (e) { }\r\n      return Number(s1.replace(\".\", \"\")) * Number(s2.replace(\".\", \"\")) / Math.pow(10, m)\r\n    },\r\n    // 输入框事件\r\n    changeInput (val) {\r\n      if (+val > this.balance) {\r\n        Toast('余额不足')\r\n        this.number = this.balance\r\n      }\r\n      this.all[0].num = this.accMul(+val, this.times)\r\n    },\r\n    // 我的收益领取\r\n    async IncomeCollection () {\r\n      this.awardLoading = true\r\n      await this.getsign()\r\n      let token = localStorage.getItem('token')\r\n      if (token) {\r\n        let res = await award()\r\n        console.log(res)\r\n        // nonce\r\n        // amount\r\n        this.awardLoading = false\r\n        this.grandTotalAward = 0\r\n        // Toast(this.$t('receive') + this.$t('success'))\r\n        this.receiveAward(res)\r\n      }\r\n    },\r\n    // 领取之后销毁合约\r\n    async receiveAward (res) {\r\n      let mount = BigToSmall.pow(res.amount, 18)\r\n      await this.$store.state.destroyContractInstance.methods\r\n        .receiveAward(res.address, mount, res.sign)\r\n        .send({\r\n          from: this.address,\r\n        })\r\n        .then((res) => {\r\n          this.awardLoading = false\r\n          this.getBalanceOf(this.srscontractInstance, this.address)\r\n          console.log('res', res)\r\n        })\r\n        .catch((err) => {\r\n          Toast(this.$t('cancel'))\r\n          this.awardLoading = false\r\n        })\r\n    },\r\n    async information () {\r\n      let token = localStorage.getItem('token')\r\n      let data = {\r\n        address: this.address,\r\n        sign: this.sign\r\n      }\r\n      // 登录 销毁记录，领取，领取记录调用\r\n      if (!token) {\r\n        let res = await loginDestroy(data)\r\n        localStorage.setItem('token', res.data)\r\n      } else {\r\n        let res = await getInfo()\r\n        // grandTotalAward 累计奖励 我的收益 领取\r\n        // historyTotalAward 总收益\r\n        // teamAwardLevel --\r\n        // teamBurnAmount // 团队销毁\r\n        // totalAmount\r\n        if (res && +res.grandTotalAward == 0) {\r\n          this.awardDisabled = true\r\n        } else {\r\n          this.awardDisabled = false\r\n        }\r\n        if (res) {\r\n          this.grandTotalAward = res.grandTotalAward\r\n          this.all[1].num = res.historyTotalAward\r\n          this.all[2].num = res.teamBurnAmount\r\n          //           for(let i in this.all) {\r\n          //             if(this.all[i].name == 'allProfit') {\r\n          // this.all[i].num = res.historyTotalAward\r\n          //             } else if (this.all[i].name == 'teamDestroy') {\r\n          // this.all[i].num = res.teamBurnAmount\r\n          //             }\r\n          //           }\r\n        }\r\n      }\r\n    },\r\n    // 获取签名-登录\r\n    async getsign () {\r\n      clearInterval(this.timer)\r\n      let sign = JSON.parse(localStorage.getItem('signDestry'))\r\n      let token = localStorage.getItem('token')\r\n      if (sign && sign.address == this.address) {\r\n        this.sign = sign.sign\r\n        this.information(token)\r\n        this.timer = setInterval(() => {\r\n          this.information(token)\r\n        }, 3000)\r\n      } else {\r\n        try {\r\n          this.sign = await web3.eth.personal.sign(\"welcome to SRS-NFT-DAO\", this.address)\r\n          console.log('地址签名', this.sign)\r\n          // let data = {\r\n          //   address: this.address,\r\n          //   sign: this.sign\r\n          // }\r\n          // let res = await loginDestroy(data)\r\n          // localStorage.setItem('token', res.data)\r\n          let val = {\r\n            sign: this.sign,\r\n            address: this.address\r\n          }\r\n          if (this.sign) localStorage.setItem('signDestry', JSON.stringify(val))\r\n          this.information(token)\r\n          this.timer = setInterval(() => {\r\n            this.information(token)\r\n          }, 3000)\r\n          return this.sign\r\n        } catch (e) {\r\n          this.awardLoading = false\r\n          if (this.address && this.userRefuseSign == false) {\r\n            Dialog.confirm({\r\n              title: this.$t('prompt'),\r\n              confirmButtonColor: '#1F75D9',\r\n              message: this.$t('signature'),\r\n            })\r\n              .then(() => {\r\n                this.getsign()\r\n              })\r\n              .catch(() => {\r\n                // on cancel 用户拒绝签名\r\n                this.userRefuseSign = true\r\n                localStorage.setItem('userRefuseSign', true)\r\n                localStorage.removeItem('signDestry')\r\n                localStorage.removeItem('token')\r\n              });\r\n          }\r\n          console.log('error', e)\r\n        }\r\n      }\r\n    },\r\n    userOperation () {\r\n      if (+this.allowance == 0) {\r\n        this.obtainAuthorization()\r\n      } else {\r\n        this.userDestroy()\r\n      }\r\n    },\r\n    // srs余额\r\n    async getBalanceOf (srscontractInstance, val) {\r\n      console.log(srscontractInstance, val)\r\n      let balance = await srscontractInstance.methods.balanceOf(val).call()\r\n      this.balance = +balance ? (balance / Math.pow(10, 18)).toFixed(4) : 0\r\n      this.$store.dispatch('ActionsSetMySRS', this.balance)\r\n      this.btnLoading = false\r\n      console.log('我的srs余额', this.balance)\r\n    },\r\n    // 获取授权\r\n    async obtainAuthorization () {\r\n      this.btnLoading = true\r\n      // 授权 BigToSmall.pow小转大 默认授权1亿\r\n      let mount = BigToSmall.pow(100000000, 18)\r\n      await this.$store.state.srscontractInstance.methods\r\n        .approve(destroyAddress, mount)\r\n        .send({\r\n          from: this.address,\r\n        })\r\n        .then(async (res) => {\r\n          this.btnLoading = false\r\n          console.log('res', res)\r\n          // 查询授权数量\r\n          await this.getAllowance()\r\n        })\r\n        .catch((err) => {\r\n          Toast(this.$t('cancel'))\r\n          this.btnLoading = false\r\n        })\r\n    },\r\n    // 查询授权数量\r\n    async getAllowance () {\r\n      let quantity = await this.$store.state.srscontractInstance.methods\r\n        .allowance(this.address, destroyAddress)\r\n        .call()\r\n      this.allowance = quantity / BigToSmall.pow(10, 18)\r\n      console.log(this.allowance, 'destroy')\r\n      if (this.allowance) {\r\n        this.btnText = 'destroy'\r\n      } else {\r\n        this.btnText = 'approve'\r\n      }\r\n      this.btnLoading = false\r\n    },\r\n    // 销毁\r\n    async userDestroy () {\r\n      if (!this.number) return\r\n      this.btnLoading = true\r\n      let num = BigToSmall.pow(this.number, 18)\r\n      await this.$store.state.destroyContractInstance.methods\r\n        .burn(num, this.current)\r\n        .send({\r\n          from: this.address,\r\n        })\r\n        .then((res) => {\r\n          this.btnLoading = false\r\n          Toast(this.$t('success'))\r\n          this.number = ''\r\n          this.getBalanceOf(this.srscontractInstance, this.address)\r\n          // this.btnText = 'stake'\r\n          console.log('res', res)\r\n        })\r\n        .catch((err) => {\r\n          Toast(this.$t('cancel'))\r\n          this.btnLoading = false\r\n        })\r\n    },\r\n    async to (type) {\r\n      this.type = type\r\n      let token = localStorage.getItem('token')\r\n      if (!token) {\r\n        let res = await this.getsign()\r\n        if (res) {\r\n          setTimeout(() => {\r\n            this.$router.push({\r\n              path: 'NFTrecords',\r\n              query: {\r\n                type: type\r\n              }\r\n            })\r\n          }, 500);\r\n        }\r\n      } else {\r\n        this.$router.push({\r\n          path: 'NFTrecords',\r\n          query: {\r\n            type: type\r\n          }\r\n        })\r\n      }\r\n    }\r\n  },\r\n  beforeRouteLeave (to, from, next) {\r\n    if (this.type == 1) {\r\n      to.meta.title = 'meta.destroyRecords'\r\n    }\r\n    if (this.type == 2) {\r\n      to.meta.title = 'meta.NFTrecords'\r\n    }\r\n    next()\r\n  },\r\n  destroyed () {\r\n    clearInterval(this.timer)\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.destroy {\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding-bottom: 10px;\r\n  .main {\r\n    padding: 5px 10px;\r\n    .profit {\r\n      .receive {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n        padding: 16px 0;\r\n        .btns {\r\n          width: 60px;\r\n          height: 27px;\r\n          background: #1f75d9;\r\n          border-radius: 13px;\r\n          font-size: 12px;\r\n          font-weight: 500;\r\n          color: #ffffff;\r\n          line-height: 27px;\r\n          text-align: center;\r\n          padding: 0;\r\n          /deep/.van-button__content {\r\n            line-height: 1;\r\n          }\r\n        }\r\n        .lpNum {\r\n          display: flex;\r\n          align-items: flex-end;\r\n          .n {\r\n            font-size: 19px;\r\n            font-weight: bold;\r\n            color: #1f75d9;\r\n            line-height: 1;\r\n          }\r\n          .unit {\r\n            font-size: 12px;\r\n            transform: scale(0.75);\r\n            transform-origin: left bottom;\r\n            font-weight: bold;\r\n            color: #909cba;\r\n            margin-left: 8px;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .profit,\r\n    .box {\r\n      background: #ffffff;\r\n      border-radius: 10px;\r\n      padding: 0 11px;\r\n      .my {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n        border-bottom: 1px solid #c7cddc;\r\n        padding-top: 25px;\r\n        padding-bottom: 11px;\r\n        width: 101%;\r\n        .tip {\r\n          font-size: 14px;\r\n          font-weight: bold;\r\n          color: #333333;\r\n        }\r\n        .records {\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: space-between;\r\n          span {\r\n            font-size: 14px;\r\n            font-weight: 400;\r\n            color: #1f75d9;\r\n            margin-right: 5px;\r\n          }\r\n          i {\r\n            color: #2a2d37;\r\n            transform: rotate(180deg);\r\n            margin-right: 0;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .content {\r\n      .all {\r\n        display: flex;\r\n        flex-direction: column;\r\n        .line {\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: space-between;\r\n          margin-bottom: 22px;\r\n          div {\r\n            font-size: 14px;\r\n            font-weight: 400;\r\n            color: #333333;\r\n          }\r\n          span {\r\n            font-size: 14px;\r\n            font-weight: 500;\r\n            color: #1f75d9;\r\n          }\r\n        }\r\n        .line:last-child {\r\n          margin-bottom: 20px;\r\n        }\r\n      }\r\n      .option {\r\n        display: flex;\r\n        margin-bottom: 24px;\r\n        .items {\r\n          margin-right: 12px;\r\n          width: 80px;\r\n          height: 32px;\r\n          background: #ffffff;\r\n          border: 1px solid #909cba;\r\n          border-radius: 3px;\r\n          font-size: 14px;\r\n          font-weight: 400;\r\n          color: #333333;\r\n          line-height: 32px;\r\n          box-sizing: border-box;\r\n          text-align: center;\r\n        }\r\n        .active {\r\n          background: rgba(31, 117, 217, 0.1);\r\n          border: 1px solid #1f75d9;\r\n        }\r\n      }\r\n      .input {\r\n        height: 39px;\r\n        background: #f6f6f6;\r\n        border-radius: 3px;\r\n        margin-top: 11px;\r\n        display: flex;\r\n        flex-direction: row;\r\n        align-items: center;\r\n        padding-left: 12px;\r\n        padding-right: 15px;\r\n        margin-bottom: 15px;\r\n        .inputStyle {\r\n          padding: 0;\r\n          background-color: transparent;\r\n        }\r\n        .times {\r\n          font-size: 14px;\r\n          font-weight: 400;\r\n          color: #1f75d9;\r\n          flex-shrink: 0;\r\n          margin-left: 15px;\r\n        }\r\n      }\r\n      .btn {\r\n        margin: 15px 0;\r\n        font-size: 16px;\r\n      }\r\n    }\r\n    .icon {\r\n      margin-bottom: 5px;\r\n      display: flex;\r\n      flex-direction: row;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      padding: 12px;\r\n      background: #ffffff;\r\n      border-radius: 10px;\r\n      .slide {\r\n        display: flex;\r\n        flex-direction: row;\r\n        align-items: center;\r\n      }\r\n      .balc {\r\n        font-size: 19px;\r\n        font-weight: bold;\r\n        color: #1f75d9;\r\n        line-height: 1;\r\n      }\r\n      .images {\r\n        width: 40px;\r\n        height: 40px;\r\n        margin-right: 17px;\r\n      }\r\n      .lp {\r\n        font-size: 14px;\r\n        font-weight: bold;\r\n        color: #333333;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=33f218c9&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=33f218c9&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"33f218c9\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}